<html>
<script src='https://d3js.org/d3.v5.min.js'></script>
<style> rect {fill: lightblue; stroke: black; }</style>
<body onload='init()'>
<svg width=300 height=300 id="bar1"></svg>
<svg width=300 height=300 id="bar2"></svg>
<script>
async function init() {
  var data1 = [4,8,15,16,23,42];
  var data2 = [14,18,25,26,33,52];

  var hightdomain = ['4','42'];
  var hightrange = ['19.0476','200'];
  var width = 200;
  var height = 200;
  var x = d3.scaleBand().domain([0,1,2,3,4,5]).range([0, width])
  var y = d3.scaleLinear().domain([0,42]).range([height,0])
  var height = d3.scaleLinear().domain(hightdomain).range(hightrange);
  var margin = 50;
  var hgh = 200
  
    // First
    d3.select('#bar1')
    .append('g')
    .attr('transform', 'translate(50,50)')
    .selectAll('rect')
    .data(data1)
    .enter()
    .append("rect")
    .attr("x", function(d,i) { return x(i); })
    .attr("y", y)
    .attr("width", x.bandwidth())
    .attr('height',function(d,i) {return  height(d);}); 
    d3.select("#bar1").append("g")
    .attr("transform", "translate("+margin+","+margin+")")
    .call(d3.axisLeft(y));
 
    d3.select("#bar1").append("g")
    .attr("transform",  "translate("+margin+","+(hgh+margin)+")")
    .call(d3.axisBottom(x));  
  
    
    var dataloc = "https://flunky.github.io/cars2017.csv"
    var dataloc = "https://gist.githubusercontent.com/amberved/f8314f883cc95d18f5f3a205b1bd3cb8/raw/568725c0976c8cfa1054e2b45f2458c6dfbea39c/city_population_crossworld.csv"
    //name,group,year,value,subGroup,city_id,lastValue,lat,lon
    
    const data = await d3.csv(dataloc);
  
    data.forEach(function(d) {
      d.name = d.name;
      d.group = d.group;
      d.year = +d.year;
      d.subGroup = d.subGroup;
      d.value = +d.value;
      d.city_id = d.city_id;
      d.lastValue = +d.lastValue;
      d.lat = +d.lat;
      d.lon = +d.lon;
    });
    
    minLon = d3.min(data, function(d) { return d.lon; });
    maxLon = d3.max(data, function(d) { return d.lon; });
    minLat = d3.min(data, function(d) { return d.lat; });
    maxLat = d3.max(data, function(d) { return d.lat; });
    
    console.log('Min lon = ' + minLon);
    console.log('Max lon = ' + maxLon);
    console.log('Min lat = ' + minLat);
    console.log('Max lat = ' + maxLat);
 
    const distinctYears = [...new Set(data.map(x => x.year))];
    const distinctCities = [...new Set(data.map(x => x.name))];
    
    console.log("Years= " +  distinctYears);
    console.log("Cities= " +  distinctCities);
  
    console.log(data[0]);
  
    //Second
    d3.select('#bar2')
    .append('g')
    .attr('transform', 'translate(50,50)')
    .selectAll('rect')
    .data(data2)
    .enter()
    .append("rect")
    .attr("x", function(d,i) { return x(i); })
    .attr("y", y)
    .attr("width", x.bandwidth())
    .attr('height',function(d,i) {return  height(d);}); 
  
    d3.select("#bar2").append("g")
    .attr("transform", "translate("+margin+","+margin+")")
    .call(d3.axisLeft(y));
 
    d3.select("#bar2").append("g")
    .attr("transform",  "translate("+margin+","+(hgh+margin)+")")
    .call(d3.axisBottom(x));  
  
  }
  
</script>
</body>
</html>
